# Audit Log - Landing Page - 2025-01-20 15:15:00

## Prompt Summary
User reported error when running the SQL script: `column "email" of relation "admin_users" does not exist`

## Actions Taken
1. Checked the actual admin_users table structure in migrations
2. Found that admin_users table doesn't have an email column
3. Created corrected SQL script without email column
4. Updated documentation with correct SQL

## Files Changed
- `scripts/create-admin-user-fixed.sql` - Created corrected SQL script
- `docs/ADMIN_INVITE_GUIDE.md` - Updated with correct SQL query

## Root Cause
The admin_users table structure doesn't include an email column. It only has:
- user_id (references auth.users)
- role
- permissions
- is_active
- Other metadata fields

The email is stored in the auth.users table, not admin_users.

## Solution
Remove the email column from the INSERT statement. The correct query only needs:
- user_id
- role
- is_active
- permissions
- timestamps

## Correct SQL to Use
```sql
-- Step 1: Get user ID
SELECT id, email FROM auth.users WHERE email = 'sami@pixelversestudios.io';

-- Step 2: Create admin (use ID from step 1)
INSERT INTO admin_users (
    user_id, role, is_active, permissions
) VALUES (
    'USER_ID_HERE', 'admin', true,
    '{"dashboard": true, "users": true, "settings": true}'::jsonb
) ON CONFLICT (user_id) DO UPDATE SET is_active = true;
```

## Testing Considerations
- Verify user exists in auth.users first
- Check admin_users table after insert
- Test login with the user account

## Performance Impact
- None

## Next Steps
1. Run the corrected SQL in Supabase
2. Test admin login

## Timestamp
Created: 2025-01-20 15:15:00
Page Section: admin/database